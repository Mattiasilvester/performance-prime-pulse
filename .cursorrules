# Cursor Rules per Performance Prime - App Unificata

## Contesto del Progetto
Questo √® un'applicazione React/TypeScript unificata per il fitness e il benessere. Include funzionalit√† di AI coach, tracking dei workout, pianificazione e integrazione con Supabase. 

**Stato Attuale (8 Agosto 2025)**: 
- ‚úÖ **App unificata funzionante** con deploy stabile su `performanceprime.it`
- ‚úÖ **Architettura unificata** - Landing + Auth + MVP tutto insieme
- ‚úÖ **Flusso completo:** Landing ‚Üí Auth ‚Üí Dashboard (stessa app)
- ‚úÖ **Autenticazione Supabase** funzionante
- ‚úÖ **Dashboard protetta** e responsive
- ‚úÖ **Overlay corretto** - Funzioni premium bloccate con design coerente
- ‚úÖ **Layout corretto** - Header + Main Content (senza menu laterale)
- ‚úÖ **Sidebar sinistra completamente rimossa**
- ‚úÖ **Barra di navigazione inferiore** implementata
- ‚úÖ **Sezioni complete:** Dashboard, Allenamento, Appuntamenti, Coach AI, Profilo
- ‚úÖ **Configurazione DNS Aruba completata**
- ‚úÖ **Dominio personalizzato configurato**
- ‚úÖ **Problema analytics risolto** - App funzionante in locale
- ‚úÖ **Analytics Plausible temporaneamente disabilitato** per debugging
- ‚úÖ **Layout alternato nero/grigio landing page**
- ‚úÖ **Sezione founders spostata in CTA**
- ‚úÖ **Card founders orizzontali su desktop**
- ‚úÖ **Nuovo contenuto Hero** - Blocco descrittivo aggiunto
- ‚úÖ **Card features grigie** - "Cosa puoi fare" e "Perch√© √® diversa"
- ‚úÖ **Spacing ottimizzato** - Ridotto spazio verticale tra elementi
- ‚úÖ **Social proof rimosso** - Design pi√π pulito
- ‚úÖ **Animazioni globali** - Fade-in/slide-up implementate
- ‚úÖ **Linea divisoria oro** - Sostituisce testi specifici
- ‚úÖ **Tagline allenamenti** - Aggiunta sotto card features
- ‚úÖ **Card allenamenti dedicata** - Trasformata in card separata
- ‚úÖ **Posizionamento card** - Centrata sotto Community
- ‚úÖ **Sistema consenso file** - Banner e sezione impostazioni implementati
- ‚úÖ **Analisi OCR file** - Riconoscimento automatico esercizi da immagini/PDF
- ‚úÖ **Integrazione allegati** - Caricamento file nel modal creazione allenamento
- ‚úÖ **Pattern matching** - Riconoscimento formati italiani e inglesi
- ‚úÖ **Componente risultati** - FileAnalysisResults per rivedere esercizi estratti
- ‚úÖ **Hook useFileAccess** - Gestione stato consenso con localStorage
- ‚úÖ **Servizio FileAnalyzer** - OCR avanzato con database 50+ esercizi
- ‚úÖ **Chat PrimeBot Modal Overlay** - Implementazione completa con backdrop sfocato
- ‚úÖ **UI Chat ottimizzata** - Area messaggi grigia e bubble bot bianchi
- ‚úÖ **Contrasto migliorato** - Leggibilit√† ottimizzata per messaggi bot
- ‚úÖ **PARSER RIGOROSO** - Sistema che legge SOLO dati reali dal PDF
- ‚úÖ **Validazione critica** - Verifica esercizi, serie, nomi corretti
- ‚úÖ **Debug dettagliato** - Log completo di ogni passo del parsing
- ‚úÖ **Pattern conservativi** - Meglio non parsare che parsare male
- ‚úÖ **Estrazione testo reale** - Solo quello che c'√® nel PDF
- ‚úÖ **SISTEMA PARSER SICURO** - Eliminazione completa contenuti binari e metadati PDF
- ‚úÖ **SafeTextExtractor** - Pulizia aggressiva di contenuti binari e filtri intelligenti
- ‚úÖ **Formato JSON strutturato** - Output esattamente come richiesto
- ‚úÖ **Correzioni automatiche** - Normalizzazione Unicode, ricostruzione sillabazioni
- ‚úÖ **Suggerimenti automatici** - Riscaldamento e stretching intelligenti
- ‚úÖ **Pattern robusti** - Riconoscimento esercizi con pattern avanzati
- ‚úÖ **Debug completo** - Informazioni dettagliate di processamento

## Architettura Unificata (Nuova)
### **App Unificata (performanceprime.it)**
- **URL:** `https://performanceprime.it`
- **Entry:** `index.html` ‚Üí `src/main.tsx` ‚Üí `src/App.tsx`
- **Config:** `vite.config.ts`
- **Scopo:** App completa con landing + auth + MVP

### **Routing Unificato**
```typescript
// src/App.tsx - App unificata
<Routes>
  {/* HOMEPAGE: Landing page per utenti non autenticati */}
  <Route path="/" element={<SmartHomePage />} />
  
  {/* AUTH: Pagina di autenticazione unificata */}
  <Route path="/auth" element={<Auth />} />
  
  {/* MVP DASHBOARD: Route protette per utenti autenticati */}
  <Route path="/dashboard" element={<ProtectedRoute><Dashboard /></ProtectedRoute>} />
  <Route path="/workouts" element={<ProtectedRoute><Workouts /></ProtectedRoute>} />
  <Route path="/schedule" element={<ProtectedRoute><Schedule /></ProtectedRoute>} />
  <Route path="/ai-coach" element={<ProtectedRoute><AICoach /></ProtectedRoute>} />
  <Route path="/profile" element={<ProtectedRoute><Profile /></ProtectedRoute>} />
  
  {/* PAGINE LEGALI: Accessibili a tutti */}
  <Route path="/privacy-policy" element={<PrivacyPolicy />} />
</Routes>
```

## Tecnologie Principali
- React 18+ con TypeScript
- Capacitor per app mobile (iOS/Android)
- Supabase per backend e autenticazione
- Tailwind CSS per styling
- Shadcn/ui per componenti UI
- Vite come build tool
- Lovable per deploy
- Aruba per DNS
- Plausible Analytics (temporaneamente disabilitato)
- Zod per validazione schema
- pdfjs-dist per estrazione PDF (opzionale)

## Convenzioni di Codice
- Usa TypeScript strict mode
- Preferisci functional components con hooks
- Usa named exports invece di default exports
- Segui la convenzione camelCase per variabili e funzioni
- Usa PascalCase per componenti React
- Mantieni i componenti piccoli e focalizzati

## Struttura del Progetto
- `/src/App.tsx` - Router principale UNIFICATO
- `/src/main.tsx` - Entry point UNIFICATO
- `/src/landing/` - Componenti landing page (ZONA SICURA)
  - `/src/landing/pages/` - Pagine landing (LandingPage, AuthPage)
  - `/src/landing/components/` - Componenti landing (Hero, Features, CTA, Footer)
  - `/src/landing/lib/` - Configurazioni landing (supabase.ts)
  - `/src/landing/styles/` - Stili landing (landing.css)
- `/src/pages/` - Pagine MVP (PROTETTE)
- `/src/components/` - Componenti MVP (PROTETTI)
- `/src/shared/` - Codice condiviso (config, hooks, ui, integrations)
- `/src/development/` - Features in sviluppo (ZONA SICURA)
- `/src/experimental/` - Sperimentazioni (ZONA SICURA)
- `/src/services/` - Servizi di parsing e processamento (ZONA SICURA)
  - `/src/services/SafeTextExtractor.ts` - Estrazione testo sicura
  - `/src/services/SchedaParser.ts` - Parsing scheda allenamento
  - `/src/services/TextProcessor.ts` - Processamento testo avanzato
  - `/src/services/FileProcessor.ts` - Gestione file integrata

## Configurazioni Vite
### **App Unificata**
- **File:** `vite.config.ts`
- **Entry:** `index.html` ‚Üí `src/main.tsx`
- **Build:** `npm run build:public`
- **Dev Server:** Porta 8082 (automatica)

## Scripts Package.json
- `npm run dev` - App unificata (porta 8082)
- `npm run build:public` - Build produzione
- `npm run deploy:lovable` - Deploy Lovable

## Styling
- Usa Tailwind CSS per lo styling
- Preferisci componenti Shadcn/ui quando disponibili
- Mantieni la coerenza con il design system esistente
- Usa variabili CSS per colori e spacing
- **Landing page:** Stili in `src/landing/styles/landing.css`

## Database e API
- Usa Supabase per tutte le operazioni di database
- Implementa proper error handling per le API calls
- Usa TypeScript types per i dati del database
- Segui le convenzioni di naming di Supabase

## Mobile (Capacitor)
- Considera sempre la compatibilit√† mobile
- Usa responsive design
- Testa su dispositivi reali quando possibile
- Gestisci correttamente le API native di Capacitor

## AI e Machine Learning
- Implementa funzionalit√† AI in modo sicuro
- Valida sempre gli input dell'utente
- Fornisci feedback chiaro per le operazioni AI
- Mantieni la privacy dell'utente

## Performance
- Ottimizza il bundle size
- Usa lazy loading per i componenti pesanti
- Implementa caching appropriato
- Monitora le performance su dispositivi mobili

## Sicurezza
- Valida sempre gli input dell'utente
- Usa HTTPS per tutte le comunicazioni
- Implementa proper authentication
- Proteggi i dati sensibili

## Testing
- Scrivi test per le funzionalit√† critiche
- Usa React Testing Library per i test dei componenti
- Testa le integrazioni con Supabase
- Verifica la compatibilit√† mobile

## Documentazione
- Commenta il codice complesso
- Mantieni README aggiornato
- Documenta le API custom
- Fornisci esempi di utilizzo

## üö® PROTEZIONE CODICE PRODUZIONE

### **File Protetti (NON MODIFICARE)**
```
src/App.tsx                    # ‚Üê Router principale PROTETTO
src/main.tsx                   # ‚Üê Entry point PROTETTO
src/pages/                     # ‚Üê Pagine MVP PROTETTE
package.json                   # ‚Üê Scripts build PROTETTI
vite.config.ts                 # ‚Üê Config build PROTETTA
index.html                     # ‚Üê HTML entry PROTETTO
```

### **Zone Sicure per Sviluppo**
```
src/landing/                   # ‚Üê Landing page (ZONA SICURA)
‚îú‚îÄ‚îÄ pages/
‚îú‚îÄ‚îÄ components/
‚îî‚îÄ‚îÄ styles/

src/services/                  # ‚Üê Servizi di parsing (ZONA SICURA)
‚îú‚îÄ‚îÄ SafeTextExtractor.ts
‚îú‚îÄ‚îÄ SchedaParser.ts
‚îú‚îÄ‚îÄ TextProcessor.ts
‚îî‚îÄ‚îÄ FileProcessor.ts

src/components/                # ‚Üê Componenti MVP (ZONA SICURA)
‚îú‚îÄ‚îÄ WorkoutUploader.tsx
‚îú‚îÄ‚îÄ ManualWorkoutInput.tsx
‚îî‚îÄ‚îÄ SchedaView.tsx
```

### **Regole Operative**
- ‚úÖ **Leggere** i file per reference
- ‚úÖ **Analizzare** il codice per capire funzionalit√†
- ‚úÖ **Copiare** parti per nuove features
- ‚úÖ **Suggerire** miglioramenti senza modificare
- ‚úÖ **Modificare** solo `src/landing/` per landing page
- ‚úÖ **Modificare** `src/services/` per parser e processamento
- ‚úÖ **Modificare** `src/components/` per componenti MVP
- ‚ùå **Modificare** file protetti senza permesso
- ‚ùå **Rinominare** file o cartelle protette
- ‚ùå **Spostare** componenti protetti
- ‚ùå **Cambiare** configurazioni build

### **Controlli di Sicurezza**
Prima di ogni modifica verifica:
1. ‚ùì "Questa modifica tocca file di produzione?"
2. ‚ùì "L'utente ha esplicitamente richiesto questo cambio?"
3. ‚ùì "Potrebbe rompere il deploy funzionante?"
4. ‚ùì "√à davvero necessaria o solo un 'miglioramento'?"

Se risposta √® S√å a qualsiasi domanda ‚Üí FERMA e CHIEDI CONFERMA

## Quando Suggerisci Modifiche
- Mantieni la coerenza con il codice esistente
- Considera l'impatto sulle performance
- Verifica la compatibilit√† mobile
- Assicurati che le modifiche seguano le convenzioni del progetto
- Testa sempre l'app unificata
- Verifica che il flusso Landing ‚Üí Auth ‚Üí MVP funzioni correttamente
- Mantieni aggiornata la documentazione
- **NON toccare file protetti senza permesso esplicito**
- **MODIFICA SOLO `src/landing/` per landing page**
- **MODIFICA SOLO `src/services/` per parser e processamento**

## Problemi Risolti Recentemente (8 Agosto 2025)
- ‚úÖ **App unificata** - Landing + Auth + MVP tutto insieme
- ‚úÖ **Merge incompleto risolto** - Repository pulito
- ‚úÖ **Configurazione Lovable corretta** - Entry point `index.html`
- ‚úÖ **Build unificato** - Un solo build per tutto
- ‚úÖ **Router unificato** - Tutto in `src/App.tsx`
- ‚úÖ **Deploy stabile** - Funzionante su `performanceprime.it`
- ‚úÖ **Protezione codice produzione** - File protetti identificati
- ‚úÖ **Configurazione DNS Aruba** - Record CNAME configurato
- ‚úÖ **Dominio personalizzato** - `performanceprime.it` attivo
- ‚úÖ **Problema analytics risolto** - App funzionante in locale
- ‚úÖ **Analytics Plausible disabilitato** - Per debugging e stabilit√†
- ‚úÖ **Layout alternato landing page** - Nero/grigio implementato
- ‚úÖ **Sezione founders spostata** - Da Hero a CTA
- ‚úÖ **Card founders orizzontali** - Layout responsive corretto
- ‚úÖ **Nuovo contenuto Hero** - Blocco descrittivo aggiunto
- ‚úÖ **Card features grigie** - "Cosa puoi fare" e "Perch√© √® diversa"
- ‚úÖ **Spacing ottimizzato** - Ridotto spazio verticale tra elementi
- ‚úÖ **Social proof rimosso** - Design pi√π pulito
- ‚úÖ **Animazioni globali** - Fade-in/slide-up implementate
- ‚úÖ **Linea divisoria oro** - Sostituisce testi specifici
- ‚úÖ **Tagline allenamenti** - Aggiunta sotto card features
- ‚úÖ **Card allenamenti dedicata** - Trasformata in card separata
- ‚úÖ **Posizionamento card** - Centrata sotto Community
- ‚úÖ **Sistema consenso file** - Banner e sezione impostazioni implementati
- ‚úÖ **Analisi OCR file** - Riconoscimento automatico esercizi da immagini/PDF
- ‚úÖ **Integrazione allegati** - Caricamento file nel modal creazione allenamento
- ‚úÖ **Pattern matching** - Riconoscimento formati italiani e inglesi
- ‚úÖ **Componente risultati** - FileAnalysisResults per rivedere esercizi estratti
- ‚úÖ **Hook useFileAccess** - Gestione stato consenso con localStorage
- ‚úÖ **Servizio FileAnalyzer** - OCR avanzato con database 50+ esercizi
- ‚úÖ **Chat PrimeBot Modal Overlay** - Implementazione completa con backdrop sfocato
- ‚úÖ **UI Chat ottimizzata** - Area messaggi grigia e bubble bot bianchi
- ‚úÖ **Contrasto migliorato** - Leggibilit√† ottimizzata per messaggi bot
- ‚úÖ **PARSER RIGOROSO** - Sistema che legge SOLO dati reali dal PDF
- ‚úÖ **Validazione critica** - Verifica esercizi, serie, nomi corretti
- ‚úÖ **Debug dettagliato** - Log completo di ogni passo del parsing
- ‚úÖ **Pattern conservativi** - Meglio non parsare che parsare male
- ‚úÖ **Estrazione testo reale** - Solo quello che c'√® nel PDF
- ‚úÖ **SISTEMA PARSER SICURO** - Eliminazione completa contenuti binari e metadati PDF
- ‚úÖ **SafeTextExtractor** - Pulizia aggressiva di contenuti binari e filtri intelligenti
- ‚úÖ **Formato JSON strutturato** - Output esattamente come richiesto
- ‚úÖ **Correzioni automatiche** - Normalizzazione Unicode, ricostruzione sillabazioni
- ‚úÖ **Suggerimenti automatici** - Riscaldamento e stretching intelligenti
- ‚úÖ **Pattern robusti** - Riconoscimento esercizi con pattern avanzati
- ‚úÖ **Debug completo** - Informazioni dettagliate di processamento

## Flusso Utente Completo
```
performanceprime.it/
‚îú‚îÄ‚îÄ /                    ‚Üí Landing page (non autenticati)
‚îú‚îÄ‚îÄ /auth               ‚Üí Login/registrazione
‚îú‚îÄ‚îÄ /dashboard          ‚Üí Dashboard MVP (autenticati)
‚îú‚îÄ‚îÄ /workouts           ‚Üí Allenamenti MVP
‚îú‚îÄ‚îÄ /schedule           ‚Üí Appuntamenti MVP
‚îú‚îÄ‚îÄ /ai-coach           ‚Üí Coach AI MVP
‚îú‚îÄ‚îÄ /profile            ‚Üí Profilo MVP
‚îî‚îÄ‚îÄ /privacy-policy     ‚Üí Pagine legali
```

## Layout Corretto
- **Header:** Logo "DD" + "Performance Prime" + menu dropdown utente
- **Main Content:** Dashboard con metriche, azioni rapide, progressi
- **Nessuna sidebar sinistra:** Rimossa completamente
- **Responsive:** Ottimizzato per mobile e desktop

## Overlay Premium
- **Lucchetto üîí** al centro per funzioni bloccate
- **Messaggio:** "Funzionalit√† in arrivo"
- **Sottotitolo:** Messaggi specifici per ogni sezione
- **Opacit√†:** Contenuto bloccato visibile sotto overlay

## Menu Dropdown
- **Utente:** Nome utente + icone (search, notifications, menu)
- **Voci:** Dashboard, Abbonamenti, Allenamento, Appuntamenti, Timer, Coach AI, Note, Profilo, Logout
- **Legale:** Termini e Condizioni, Privacy Policy (GDPR)

## Barra di Navigazione Inferiore
- **5 icone:** Dashboard, Allenamento, Appuntamenti, Coach AI, Profilo
- **Design:** Solo mobile (`lg:hidden`), tema scuro con accenti oro
- **Funzionalit√†:** Navigazione completa tra sezioni

## Funzionalit√† Accessibili
- **Dashboard:** Metriche personalizzate e statistiche
- **Allenamento:** Categorie workout e esercizi
- **Appuntamenti:** Calendario base e gestione
- **Coach AI:** Chat base, piani personalizzati, suggerimenti AI
- **Profilo:** Gestione informazioni utente, achievement, progressi, impostazioni
- **Abbonamenti:** Piani BASIC, ADVANCED, PRO con feature dettagliate
- **Timer:** Timer countdown per allenamenti con controlli completi
- **Note:** Creazione, modifica, eliminazione note personali
- **Pagine Legali:** Termini e Condizioni, Privacy Policy GDPR compliant

## Funzioni Premium (Bloccate)
- **Azioni Rapide:** "Prenota Sessione" e "Chat AI Coach" con overlay
- **Prossimi Appuntamenti:** Sezione completa con overlay
- **Professionisti:** Lista professionisti con overlay
- **Insights AI:** Analisi avanzata bloccata
- **Albo delle medaglie:** Sezione achievement con overlay
- **Contatto Professionisti:** Prenotazioni premium bloccate

## Chat PrimeBot - Modal Overlay
### **Funzionalit√† Implementate:**
- **Click sulla card AI Coach** ‚Üí Apertura chat a tutto schermo
- **Backdrop sfocato** con `bg-black/20 backdrop-blur-sm`
- **App sfocata dietro** ma visibile
- **Interazione solo con chat** quando modal √® aperta
- **Click outside per chiudere** - Backdrop interattivo
- **Pulsante X nell'header** - Solo in modal per chiudere

### **UI Ottimizzata:**
- **Area messaggi grigia:** `bg-gray-300` per contrasto
- **Bubble messaggi bot bianchi:** `bg-white` per leggibilit√†
- **Design coerente:** Bordi oro, header, layout identico
- **Responsive:** `max-w-2xl` per dimensioni ottimali

### **Struttura Modal:**
```typescript
{isFullScreenChat && (
  <div className="fixed inset-0 z-50">
    {/* Backdrop sfocato */}
    <div className="fixed inset-0 bg-black/20 backdrop-blur-sm" onClick={closeFullScreenChat} />
    
    {/* Chat Modal centrato */}
    <div className="relative z-10 flex items-center justify-center min-h-screen p-4">
      <div className="w-full max-w-2xl" onClick={(e) => e.stopPropagation()}>
        <ChatInterface ref={chatInterfaceRef} onClose={closeFullScreenChat} />
      </div>
    </div>
  </div>
)}
```

### **Componenti Modificati:**
- **AICoachPrime.tsx:** Stato modal, funzioni open/close, backdrop
- **ChatInterface.tsx:** Prop onClose, pulsante X, area messaggi grigia, bubble bianchi

## Landing Page - Ultime Modifiche
### **Layout Alternato**
```
Hero Section (NERA) ‚Üí Features Section (GRIGIA) ‚Üí CTA Section (NERA) ‚Üí Footer (GRIGIO)
```

### **Sezione Founders**
- **Posizione:** CTA Section (sotto bottone "Scansiona e inizia ora")
- **Layout:** Card orizzontali su desktop/tablet, verticali su mobile
- **Responsive:** `flex-direction: row` su desktop, `column` su mobile

### **Nuovo Contenuto Hero**
- **Blocco descrittivo:** Aggiunto sotto tagline principale
- **Performance Prime:** Titolo con descrizioni
- **Card grigie:** "Cosa puoi fare" e "Perch√© √® diversa" con sfondo grigio
- **Spacing ottimizzato:** Ridotto spazio verticale tra elementi
- **Linea divisoria oro:** Sostituisce testi specifici

### **Card Features**
- **Tagline allenamenti:** Aggiunta sotto le 6 card features
- **Card dedicata:** "Scegli il tuo tipo di allenamento" trasformata in card separata
- **Posizionamento:** Centrata sotto la card "Community"
- **Styling:** Identico alle altre card con icona e gradient

### **Zona Sicura per Sviluppo**
```
src/landing/                   # ‚Üê Landing page (MODIFICABILE)
‚îú‚îÄ‚îÄ pages/
‚îú‚îÄ‚îÄ components/
‚îî‚îÄ‚îÄ styles/
```

## Sistema Parser Sicuro - ELIMINAZIONE CONTENUTI BINARI
### **Funzionalit√† Implementate:**
- **SafeTextExtractor** - Sistema completo di estrazione testo sicuro
- **Pulizia aggressiva** - Rimuove `/BaseFont`, `/Encoding`, `endobj`, `stream`, `xref`, etc.
- **Filtro righe intelligente** - Elimina righe con solo simboli tecnici
- **Rilevamento sezioni automatico** - Identifica riscaldamento, scheda giornaliera, stretching
- **Formato JSON strutturato** - Output esattamente come richiesto
- **Correzioni automatiche** - Normalizzazione Unicode, ricostruzione sillabazioni
- **Suggerimenti automatici** - Riscaldamento e stretching intelligenti
- **Pattern robusti** - Riconoscimento esercizi con pattern avanzati
- **Debug completo** - Informazioni dettagliate di processamento

### **Principi Chiave del Parser Sicuro:**
1. **MAI restituire contenuti binari** - Solo testo leggibile dall'utente
2. **Filtri aggressivi** - Rimuove TUTTI i metadati PDF
3. **Pattern conservativi** - Meglio non parsare che parsare male
4. **Validazione rigorosa** - Verifica che i dati siano quelli attesi
5. **Debug dettagliato** - Mostra esattamente cosa sta leggendo

### **Architettura Parser Sicuro:**
```typescript
class SafeTextExtractor {
  async extractSafeText(file: File): Promise<SafeTextResult> {
    // STEP 1: Estrazione grezza
    const rawText = await this.extractRawText(file);
    
    // STEP 2: Pulizia aggressiva di contenuti binari
    const cleanedText = this.cleanBinaryContent(rawText);
    
    // STEP 3: Rilevamento sezioni
    const sections = this.detectSections(cleanedText);
    
    // STEP 4: Validazione finale
    const validation = this.validateExtractedText(cleanedText);
    
    return {
      cleanText: cleanedText,
      sections,
      metadata: {
        hasMultipleDays: sections.detectedDays?.length > 1,
        detectedDays: sections.detectedDays || [],
        extractionMethod: validation.extractionMethod,
        confidence: validation.confidence,
        warnings: validation.warnings
      }
    };
  }
}
```

### **Pulizia Aggressiva Contenuti Binari:**
```typescript
private cleanBinaryContent(text: string): string {
  return text
    // Rimuovi metadati PDF
    .replace(/\/[A-Za-z]+\s+[^\n]+/g, '') // /BaseFont, /Encoding, etc.
    .replace(/endobj\s*\d+/g, '') // endobj
    .replace(/obj\s*\d+\s*\d+/g, '') // obj
    .replace(/stream[\s\S]*?endstream/g, '') // stream content
    .replace(/xref[\s\S]*?trailer/g, '') // xref section
    .replace(/trailer[\s\S]*?startxref/g, '') // trailer
    .replace(/startxref\s*\d+/g, '') // startxref
    .replace(/%%EOF/g, '') // EOF
    
    // Rimuovi caratteri di controllo
    .replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g, '')
    
    // Rimuovi sequenze binarie comuni
    .replace(/[^\x20-\x7E\n√†√®√©√¨√≤√π√Ä√à√â√å√í√ô]/g, ' ')
    
    // Rimuovi righe con solo simboli tecnici
    .split('\n')
    .filter(line => {
      const trimmed = line.trim();
      if (!trimmed) return false;
      
      // Rimuovi righe con solo simboli tecnici
      const technicalPatterns = [
        /^\/[A-Za-z]+/, // /BaseFont, etc.
        /^obj\s*\d+/, // obj
        /^endobj/, // endobj
        /^stream/, // stream
        /^endstream/, // endstream
        /^xref/, // xref
        /^trailer/, // trailer
        /^startxref/, // startxref
        /^%%/, // Comments
        /^\d+\s+\d+\s+obj/, // Object references
        /^[0-9a-fA-F]{32,}/, // Long hex strings
        /^[^\w\s√†√®√©√¨√≤√π√Ä√à√â√å√í√ô]{10,}/, // Long sequences of symbols
      ];
      
      return !technicalPatterns.some(pattern => pattern.test(trimmed));
    })
    .join('\n')
    
    // Normalizza spazi
    .replace(/\s+/g, ' ')
    .trim();
}
```

### **Formato JSON Strutturato:**
```json
{
  "riscaldamento": [
    {
      "nome": "Mobilit√† articolare generale",
      "serie": 1,
      "ripetizioni_durata": "5 min",
      "riposo": null,
      "note": "Aggiunto automaticamente",
      "confidence": 0.1
    }
  ],
  "giorno": "Giorno 1",
  "esercizi": [
    {
      "nome": "Squat",
      "serie": 4,
      "ripetizioni_durata": "8-10",
      "riposo": "90s",
      "note": "Controllato",
      "confidence": 0.8
    }
  ],
  "stretching": [
    {
      "nome": "Stretching generale",
      "serie": 1,
      "ripetizioni_durata": "5 min",
      "riposo": null,
      "note": "Aggiunto automaticamente",
      "confidence": 0.1
    }
  ]
}
```

### **Correzioni Automatiche:**
```typescript
// Normalizzazione Unicode
√ó ‚Üí x
‚Äì/‚Äî ‚Üí -
'/'' ‚Üí '
‚Ä¶ ‚Üí ...
\u00A0 ‚Üí spazio normale
Soft hyphen \u00AD ‚Üí rimuovi
Legature: Ô¨Ä‚Üíff, Ô¨Å‚Üífi, Ô¨Ç‚Üífl, Ô¨É‚Üíffi, Ô¨Ñ‚Üíffl

// Ricostruzione sillabazioni
([A-Za-z])-\n([a-z]) ‚Üí $1$2
riga vuota = separatore sezione
singolo \n ‚Üí spazio

// Correzioni OCR
O‚Üî0, l‚Üî1, S‚Üî5, B‚Üî8 (solo in contesto numerico)
minuti|min|mins ‚Üí min
secondi|sec|s ‚Üí sec
```

### **Pattern Robusti per Esercizi:**
```typescript
const patterns = {
  esercizio: [
    // "Nome: 3x12" o "Nome 3x12"
    /^(.+?):?\s+(\d+)[x√ó](\d+(?:-\d+)?)\s*(.*)$/i,
    // "Nome: 3x30 sec" o "Nome 3x30 secondi"
    /^(.+?):?\s+(\d+)[x√ó](\d+)\s*(sec|secondi|min|minuti)\s*(.*)$/i,
    // "Nome: 3x max reps"
    /^(.+?):?\s+(\d+)[x√ó]\s*max\s+reps?\s*(.*)$/i,
    // "Nome: 3x tempo" (senza specificare unit√†)
    /^(.+?):?\s+(\d+)[x√ó](\d+)\s*(.*)$/i,
  ],
  riposo: [
    /riposo\s*(\d+)\s*(sec|secondi|min|minuti)/i,
    /(\d+)\s*(sec|secondi|min|minuti)\s*riposo/i,
  ],
  note: [
    /\((.*?)\)/, // Note tra parentesi
    /\[(.*?)\]/, // Note tra parentesi quadre
    /note:\s*(.*)/i, // Note esplicite
  ]
};
```

### **Suggerimenti Automatici:**
```typescript
// Riscaldamento automatico
private suggestRiscaldamento(esercizi: ParsedEsercizio[]): ParsedEsercizio[] {
  const riscaldamento: ParsedEsercizio[] = [
    {
      nome: 'Mobilit√† articolare generale',
      serie: 1,
      ripetizioni_durata: '5 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    },
    {
      nome: 'Cardio leggero',
      serie: 1,
      ripetizioni_durata: '5 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    }
  ];
  
  // Aggiungi riscaldamento specifico per gli esercizi trovati
  const hasSquat = esercizi.some(e => e.nome.toLowerCase().includes('squat'));
  const hasPanca = esercizi.some(e => e.nome.toLowerCase().includes('panca'));
  const hasStacco = esercizi.some(e => e.nome.toLowerCase().includes('stacco'));
  
  if (hasSquat || hasPanca || hasStacco) {
    riscaldamento.push({
      nome: 'Mobilit√† spalle e schiena',
      serie: 1,
      ripetizioni_durata: '3 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    });
  }
  
  return riscaldamento;
}

// Stretching automatico
private suggestStretching(esercizi: ParsedEsercizio[]): ParsedEsercizio[] {
  const stretching: ParsedEsercizio[] = [
    {
      nome: 'Stretching generale',
      serie: 1,
      ripetizioni_durata: '5 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    }
  ];
  
  // Aggiungi stretching specifico
  const hasUpperBody = esercizi.some(e => 
    e.nome.toLowerCase().includes('panca') || 
    e.nome.toLowerCase().includes('rematore') ||
    e.nome.toLowerCase().includes('trazioni')
  );
  
  const hasLowerBody = esercizi.some(e => 
    e.nome.toLowerCase().includes('squat') || 
    e.nome.toLowerCase().includes('stacco') ||
    e.nome.toLowerCase().includes('leg')
  );
  
  if (hasUpperBody) {
    stretching.push({
      nome: 'Stretching spalle e braccia',
      serie: 1,
      ripetizioni_durata: '3 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    });
  }
  
  if (hasLowerBody) {
    stretching.push({
      nome: 'Stretching gambe e schiena',
      serie: 1,
      ripetizioni_durata: '3 min',
      riposo: null,
      note: 'Aggiunto automaticamente',
      confidence: 0.1
    });
  }
  
  return stretching;
}
```

## Prossimi Sviluppi
- üîÑ **OCR Tesseract.js** - Implementazione completa per immagini
- üîÑ **Selezione giorni multipli** - UI per scegliere giorno specifico
- üîÑ **Modal di modifica esercizi** - Interfaccia per modificare esercizi
- üîÑ **Conferma eliminazione** - Sistema di conferma per eliminare esercizi
- üîÑ **Ottimizzazioni performance** - Miglioramento velocit√† parsing
- üîÑ **Test con PDF reali** - Validazione con file di produzione
- üîÑ **Ripristino analytics** con error handling migliorato
- üîÑ **Features sperimentali** in `src/development/`
- üîÑ **Testing e ottimizzazioni**
- üîÑ **Analytics e tracking**
- üîÑ **Mobile app deployment**
- üîÑ **Advanced AI features**
- üîÑ **Test dominio personalizzato**
- üîÑ **Ottimizzazioni landing page**
- üîÑ **OCR avanzato** - Integrazione Tesseract.js per analisi reale
- üîÑ **Machine Learning** - Miglioramento riconoscimento esercizi
- üîÑ **API OCR** - Servizio esterno per analisi pi√π accurate
- üîÑ **Batch processing** - Analisi multipli file contemporaneamente
- üîÑ **Test parser rigoroso** - Verifica con PDF reali
- üîÑ **Ottimizzazioni performance** - Miglioramento velocit√† parsing
- üîÑ **UI risultati** - Miglioramento visualizzazione esercizi estratti

## Motto Operativo
**"Se funziona, non toccarlo - sviluppa a fianco!"**

Il deploy su `performanceprime.it` √® **PERFETTO e FUNZIONANTE** con dominio personalizzato configurato, landing page ottimizzata, chat PrimeBot con modal overlay implementata e sistema parser sicuro per analisi file. Proteggi il codice di produzione e sviluppa nuove features nelle zone sicure. 